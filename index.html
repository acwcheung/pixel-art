<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Pixel Art Maker</title>
	<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
	<div class="panel">
		<form class="submit">
		<!-- the buttons in the form clicked, submit event triggered -->
			<div><label>Row</label><button class="row-minus change-grid">-</button><input type="number" name="row" value="10"><button class="row-add change-grid">+</button></div>
			<div><label>Column</label><button class="column-minus change-grid">-</button><input type="number" name="column" value="10"><button class="column-add change-grid">+</button></div>  
			<button>Create grid</button>
			<input type="color" name="box-color" value="#00ffff">
		</form>
		<div class="clear-reset">
			<!-- clear the marks on the grid and restart on existing grid  -->
			<button class="clear">Clear grid</button>
			<button class="reset">Reset grid</button>

		</div>
	</div>

	<div class="container"></div>

	<script>
		const container = document.querySelector('.container');
		const buttonGridChange = document.querySelectorAll('.change-grid');
		//value from input fields
		const row = document.querySelector('input[name=row]')
		const column = document.querySelector('input[name=column]')
		//build the grid 
		const submit = document.querySelector('.submit');
		const clear = document.querySelector('.clear');
		const reset = document.querySelector('.reset');
		//color control
		const inputColor = document.querySelector('input[type=color]');
		const defaultColor = "#00ffff";
		let boxes = [];
		let newColor = defaultColor;	//initial value is default color
		

		//add new rows and column to the existing grid?
		function createGrid(row, column) {
			let columns = [];
			let rows = [];
			for(let i = 1; i <= column; i++) {
				columns.push(`
					<div class="box" style="background: none;"></div>
				`)
			};
			for(let j = 1; j <= row; j++) {
				rows.push(`
					<div class="row">${columns.join('')}</div>
				`)
			}
			container.innerHTML = rows.join('');
			boxes = document.querySelectorAll('.box');
			boxes.forEach(box => box.addEventListener('click', addColor));
		}

		function handleCreate(e) {
			e.preventDefault();
			//keep the grids and add new rows and columns
			container.innerHTML = '';
			createGrid(row.value, column.value);
		}

		function handleChangeGrid(e) {
			if(e.target.className.includes('row')) {
				const num = parseInt(row.value);
				e.target.className.includes('minus') ? 
					row.value = num - 1: 
					row.value = num + 1;				 
			} else {
				const num = parseInt(column.value);
				e.target.className.includes('minus') ? 
					column.value = num - 1: 
					column.value = num + 1; 	
			}										
		}

		function handleClear() {
			boxes.forEach(box => {
				box.style.background = "none";
			})
		}

		function resetGrid() {
			container.innerHTML = '';
			inputColor.value = defaultColor;
			row.value = 10;
			column.value = 10;
		}

		function addColor(e) {
			box = e.target;
			if(box.style.background === "none") {
				box.style.background = newColor;			
			} else {
				box.style.background !== "none";
				box.style.background = "none";
			}			
		}
				
		submit.addEventListener('submit', handleCreate);
		buttonGridChange.forEach(button => button.addEventListener('click', handleChangeGrid));
		clear.addEventListener('click', handleClear);
		reset.addEventListener('click', resetGrid);
		inputColor.addEventListener('change', () => {
			newColor = inputColor.value;
		});
				
	</script>
</body>
</html>